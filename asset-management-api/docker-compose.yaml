version: '3'
services:
  assetsapi:
    build: 
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
      # - "8081:443"
    environment:
      ASPNETCORE_ENVIRONMENT: "Development"
      # ASPNETCORE_URLS: "https://+;http://+"
      # ASPNETCORE_HTTPS_PORT: "8081"
    # volumes:
      # - ${APPDATA}\microsoft\UserSecrets\:/root/.microsoft/usersecrets
      # - ${USERPROFILE}\.aspnet\https\:/root/.aspnet/https/
    extra_hosts:
      - "host.docker.internal:host-gateway"
    depends_on:
      msdb:
        condition: service_healthy
  msdb:
    image: "mcr.microsoft.com/mssql/server:2022-latest"
    environment:
      SA_PASSWORD: "password"
      ACCEPT_EULA: "Y"
    ports:
      - "11433:1433"
    healthcheck:
      test: [ "CMD", "curl", "-s", "http://localhost:11433" ]
      interval: 10s
      retries: 10
      start_period: 30s
      timeout: 10s

